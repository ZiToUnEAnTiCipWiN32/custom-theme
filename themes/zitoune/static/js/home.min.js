$(function(){$(window).on("resize",function(){var navbarHeight=$("#main-navbar").outerHeight(true);var height=$("body").height()-(navbarHeight+30+30);$("#content").height($("body").height()-(navbarHeight+30));$("#terminal").height(height);}).resize();var currentCategory='';var jsonQobj;jQuery.getJSON("/index.json",function(data){jsonQobj=jsonQ(data);});var term=$('#terminal').terminal({help:function()
{term.echo('[[;yellow;]ls]    - list directory contents');term.echo('[[;yellow;]cd]    - change current directory');term.echo('[[;yellow;]desc]  - display file description');term.echo('[[;yellow;]open]  - open file in browser');term.echo('[[;yellow;]clear] - clear the terminal screen');},ls:function(...args)
{var items=[];var category;if(args.length>1)
{term.error('USAGE: ls <directory>');return;}
else if(args.length==1)
{var found=false;jsonQobj.find('categories',function(){this.forEach(function(item,index){if(item==args[0]){found=true;}});});if(found==false){term.error("Directory '"+args[0]+"' Not Found!");return;}
category=args[0];}
else
{category=currentCategory;}
if(category==''){jsonQobj.find('categories',function(){if(this.length!=0){this.forEach(function(item,index){var link='<a href="/categories/'+item+'" class="category-link">'+item+'</a>'
if(jQuery.inArray(link,items)==-1){items.push(link);}});}});}
var posts=jsonQobj.find('name').parent();posts.each(function(index,path,value){if(category==''){if(value.categories.length==0)items.push('<a href="'+value.permalink+'" class="post-link">'+value.name+'</a>');}else{if(jQuery.inArray(category,value.categories)!=-1)items.push('<a href="'+value.permalink+'" class="post-link">'+value.name+'</a>');}});term.echo(items,{raw:true});},cd:function(...args)
{if(args.length==0||args[0]=='..'){currentCategory='';term.set_prompt("[[b;green;]"+'~'+"][[b;red;]$] ");}else if(args.length==1){var items=[];jsonQobj.find('categories',function(){if(this.length!=0){this.forEach(function(item,index){if(jQuery.inArray(item,items)==-1){items.push(item);}});}});if(jQuery.inArray(args[0],items)!=-1){currentCategory=args[0];term.set_prompt("[[b;green;]~"+'/'+currentCategory+"/][[b;red;]$] ");}else{term.error("Directory '"+args[0]+"' Not Found!");}}},desc:function(...args)
{var description='';if(args.length==1){var posts=jsonQobj.find('name').parent();posts.each(function(index,path,value){if(args[0]==value.name)description=value.description;});}
else{term.error('USAGE: desc <file>');return;}
if(description.length>0)term.echo(description,{raw:true});else term.error("File '"+args[0]+"' Not Found!");},open:function(...args)
{var permalink='';if(args.length==1){var posts=jsonQobj.find('name').parent();posts.each(function(index,path,value){if(args[0]==value.name)permalink=value.permalink;});}
else{term.error('USAGE: open <file>');return;}
if(permalink.length>0)window.location=permalink;else term.error("File '"+args[0]+"' Not Found!");},},{greetings:"Bienvenue :)\n"+
"Entrez la commande [[;yellow;]help] pour obtenir la liste des commandes disponibles.\n"+
"Utilisez la touche [[;DeepPink;]tab] pour la compl√©tion.\n",prompt:"[[b;green;]"+'~'+"][[b;red;]$] ",checkArity:false,onblur:function(){return false;},completion:function(string,callback)
{if(this.get_command().match(/^ls /))
{var items=[];jsonQobj.find('categories',function(){if(this.length!=0){this.forEach(function(item,index){if(jQuery.inArray(item,items)==-1){items.push(item);}});}});callback(items);}
else if(this.get_command().match(/^cd /))
{var items=['..'];jsonQobj.find('categories',function(){if(this.length!=0){this.forEach(function(item,index){if(jQuery.inArray(item,items)==-1){items.push(item);}});}});callback(items);}
else if(this.get_command().match(/^desc /))
{var items=[];var posts=jsonQobj.find('name').parent();posts.each(function(index,path,value){if(currentCategory==''){if(value.categories.length==0)items.push(value.name);}else{if(jQuery.inArray(currentCategory,value.categories)!=-1)items.push(value.name);}});callback(items);}
else if(this.get_command().match(/^open /))
{var items=[];var posts=jsonQobj.find('name').parent();posts.each(function(index,path,value){if(currentCategory==''){if(value.categories.length==0)items.push(value.name);}else{if(jQuery.inArray(currentCategory,value.categories)!=-1)items.push(value.name);}});callback(items);}
else
{callback(['help','ls','cd','desc','open','clear']);}},});});